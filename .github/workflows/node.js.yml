# name: main Branch 

# on:
#   push:
#     branches:
#       - main

# jobs:
#   build:
#     runs-on: self-hosted

#     steps:
#     - name: Checkout code
#       uses: actions/checkout@v3

#     - name: Set up Node.js
#       uses: actions/setup-node@v3
#       with:
#         node-version: '20'  
        env: 
          SSH_PRIVATE_KEY: ${{ secrets.EC2_SSH_KEY }}
          REMOTE_HOST: ${{ secrets.HOST_DNS }}
          REMOTE_USER: ${{ secrets.USERNAME }}
          TARGET: ${{ secrets.TARGET_DIR }}

# on:
#   push:
#     branches:
#       - main

# jobs:
#   build:
#     runs-on: self-hosted

#     steps:
#     - name: Checkout code
#       uses: actions/checkout@v3

#     - name: Set up Node.js
#       uses: actions/setup-node@v3
#       with:
#         node-version: '20'  

#     - name: Install dependencies
#       run: npm install 

#     - name: Build project
#       run: npm run build

#     # - name: Source movement
#     #   run: sudo cp -r /home/ubuntu/project/_work/project_frontend/project_frontend/dist/ * /var/www/html/dev

#     # - name: Nginx restart
#     #   run: sudo service nginx restart

#     - name: Install dependencies
#       run: npm install 

#     - name: Build project
#       run: npm run build

#     # - name: Source movement
#     #   run: sudo cp -r /home/ubuntu/project/_work/project_frontend/project_frontend/dist/ * /var/www/html/dev

#     # - name: Nginx restart
#     #   run: sudo service nginx restart
#     #    host: ${{ secrets.HOST_DNS }}
          username: ${{ secrets.USERNAME }}
          key: ${{ secrets.EC2_SSH_KEY }}
          script: |
            sudo apt-get -y update
            sudo apt-get install -y apache2
            sudo systemctl start apache2
            sudo systemctl enable apache2
            cd home
            sudo mv * /var/www/html
